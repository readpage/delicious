import{u as w}from"./index.f32077d6.js";import"./vendor.cfa0d6f6.js";const D={class:"cart"},A={class:"cart__header",style:{position:"relative"}},T=Vue.createElementVNode("div",{class:"title",style:{position:"absolute",left:"22px"}},[Vue.createTextVNode(" \u8D2D\u7269\u8F66 "),Vue.createElementVNode("span")],-1),F=Vue.createTextVNode("\u53BB\u901B\u901B"),R={class:"cart__content"},S={class:"item-buy"},z={class:"item-buy__check"},I={class:"item-buy__detail"},P={class:"title"},U={class:"buy__func"},$={class:"is-price"},j=["onClick"],H={class:"cart__footer"},L=Vue.createTextVNode("\u5168\u9009"),q={class:"func"},G=Vue.createTextVNode("\u5408\u8BA1: "),J={class:"is-price"},K=Vue.createTextVNode("\u53BB\u7ED3\u7B97"),M=Vue.createTextVNode("\u5220\u9664"),X=Vue.defineComponent({setup(O){Vue.useCssVars(n=>({"261064a9":Vue.unref(h)}));const m=VueRouter.useRouter(),{state:d,commit:r}=w(),{carts:u}=Vue.toRefs(d.cart),t=Vue.reactive({checkAll:!0,isIndeterminate:!1,checked:[],finish:!0,numVisible:!0,totalPrice:0}),p=Vue.computed(()=>(u.value.forEach(n=>n.btn=!1),u)),h=Vue.computed(()=>d.user.browser.innerHeight);Vue.watch(()=>u.value.length,n=>{t.checked=u.value.map(e=>e.id)},{immediate:!0,deep:!0}),Vue.watchEffect(()=>{b(t.checked)});function f(n){let e=u.value.map(c=>c.id);t.checked=n?e:[],t.isIndeterminate=!1}function V(n){t.checked=n;const e=n.length;t.checkAll=e===u.value.length,t.isIndeterminate=e>0&&e<u.value.length}function k(){let n=t.checked.map(e=>u.value.find(c=>c.id==e));r("cart/setFoods",n),m.push("/confirm-orders")}function C(){r("cart/remCart",t.checked)}function v(n){r("cart/updCart",n)}function b(n){let e=0;n.forEach(c=>{let l=u.value.find(a=>a.id==c);l&&(e+=l.buyCount*l.price)}),t.totalPrice=Number(e.toFixed(2))}VueRouter.onBeforeRouteLeave(()=>{let n=u.value.map(e=>e.id);V(n)});const{totalPrice:N}=Vue.toRefs(t);return(n,e)=>{const c=Vue.resolveComponent("router-link"),l=Vue.resolveComponent("el-empty"),a=Vue.resolveComponent("el-checkbox"),g=Vue.resolveComponent("el-image"),y=Vue.resolveComponent("el-input-number"),i=Vue.resolveComponent("el-button"),x=Vue.resolveComponent("el-space"),_=Vue.resolveComponent("el-card"),B=Vue.resolveComponent("el-checkbox-group"),E=Vue.resolveComponent("el-scrollbar");return Vue.openBlock(),Vue.createElementBlock("div",D,[Vue.createElementVNode("div",A,[Vue.createElementVNode("div",{class:"manage",onClick:e[0]||(e[0]=o=>Vue.unref(t).finish=!Vue.unref(t).finish)},Vue.toDisplayString(Vue.unref(t).finish?"\u7BA1\u7406":"\u5B8C\u6210"),1),T]),Vue.unref(u).length==0?(Vue.openBlock(),Vue.createBlock(l,{key:0,description:"\u6682\u65E0\u9910\u54C1"},{default:Vue.withCtx(()=>[Vue.createVNode(c,{to:{path:"/"}},{default:Vue.withCtx(()=>[F]),_:1})]),_:1})):(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:1},[Vue.createVNode(E,null,{default:Vue.withCtx(()=>[Vue.createElementVNode("div",R,[Vue.createVNode(B,{modelValue:Vue.unref(t).checked,"onUpdate:modelValue":e[1]||(e[1]=o=>Vue.unref(t).checked=o),onChange:V},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(p).value,o=>(Vue.openBlock(),Vue.createBlock(_,{"body-style":{padding:"10px"}},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",S,[Vue.createElementVNode("div",z,[Vue.createVNode(a,{label:o.id},null,8,["label"])]),Vue.createVNode(g,{fit:"fill",src:o.img},null,8,["src"]),Vue.createElementVNode("div",I,[Vue.createElementVNode("div",P,Vue.toDisplayString(o.name),1),Vue.createElementVNode("div",U,[Vue.createElementVNode("span",$,Vue.toDisplayString(o.price),1),o.btn?(Vue.openBlock(),Vue.createBlock(x,{key:1},{default:Vue.withCtx(()=>[Vue.createVNode(y,{size:"mini",onChange:s=>v(o),modelValue:o.buyCount,"onUpdate:modelValue":s=>o.buyCount=s,min:1},null,8,["onChange","modelValue","onUpdate:modelValue"]),Vue.createVNode(i,{type:"danger",icon:"el-icon-close",size:"mini",circle:"",onClick:s=>o.btn=!o.btn},null,8,["onClick"])]),_:2},1024)):(Vue.openBlock(),Vue.createElementBlock("div",{key:0,class:"count",onClick:s=>o.btn=!o.btn},"x"+Vue.toDisplayString(o.buyCount),9,j))])])])]),_:2},1024))),256))]),_:1},8,["modelValue"])])]),_:1}),Vue.createVNode(_,null,{default:Vue.withCtx(()=>[Vue.createElementVNode("div",H,[Vue.createVNode(a,{indeterminate:Vue.unref(t).isIndeterminate,modelValue:Vue.unref(t).checkAll,"onUpdate:modelValue":e[2]||(e[2]=o=>Vue.unref(t).checkAll=o),onChange:f},{default:Vue.withCtx(()=>[L]),_:1},8,["indeterminate","modelValue"]),Vue.createElementVNode("div",q,[Vue.unref(t).finish?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:0},[Vue.createElementVNode("span",null,[G,Vue.createElementVNode("span",J,Vue.toDisplayString(Vue.unref(N)),1)]),Vue.createVNode(i,{size:"mini",type:"info",onClick:k},{default:Vue.withCtx(()=>[K]),_:1})],64)):(Vue.openBlock(),Vue.createBlock(i,{key:1,size:"mini",type:"danger",plain:"",onClick:C},{default:Vue.withCtx(()=>[M]),_:1}))])])]),_:1})],64))])}}});export{X as default};
