var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,n=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t;import{u as o,d as i,e as s}from"./index.bf837159.js";import{I as d,r,a as u,A as c}from"./index.69843667.js";import{e as m,R as p,B as f,m as b,x as g,O as v,r as h,P as y,o as _,f as k,h as S,g as w,Q as z,G as C,t as O,L as x,v as V,b as I,U as L,F as U,E as j}from"./vendor.f7504fb0.js";const P=C();O("data-v-491cadd0");const N={class:"scrollbar"},D=x("确定"),$=x("取消");V();var F=m({props:{msg:String},emits:["submit"],setup(e,{expose:l,emit:a}){const{state:t}=o(),n=p(d),i=p(u,r),{role:s,menuIdList:c}=f(i.value),m=p("menuIds",b([])),C=b(!1),O=b(),x=g({name:{required:!0,message:"请输入角色名"},nickname:{required:!0,message:"请输入昵称"}});function V(){O.value.validate((e=>{e&&a("submit",i.value)}))}const L=b();function U(){O.value.resetFields(),L.value.setCheckedKeys([]),m.value=[]}function j(e){I.confirm("确认关闭?").then((()=>{e()}))}function F(e,l){return!e||l.title.includes(e)}const J=b("");function E(){const e=L.value.getCheckedKeys(),l=L.value.getHalfCheckedKeys();c.value=JSON.parse(JSON.stringify([...e,...l]))}return v(J,(e=>{L.value.filter(e)})),l({visible:C}),(l,a)=>{const o=h("el-input"),i=h("el-form-item"),d=h("el-tree"),r=h("el-form"),u=h("el-button"),c=h("el-dialog"),p=y("loading");return _(),k(c,{title:e.msg,modelValue:C.value,"onUpdate:modelValue":a[5]||(a[5]=e=>C.value=e),onClose:U,"before-close":j},{footer:P((()=>[S(u,{type:"primary",size:"small",loading:w(t).user.btnLoading,onClick:V},{default:P((()=>[D])),_:1},8,["loading"]),S(u,{size:"small",onClick:a[4]||(a[4]=e=>C.value=!1)},{default:P((()=>[$])),_:1})])),default:P((()=>[S(r,{model:w(s),ref:O,rules:w(x),"label-width":"80px",size:"small"},{default:P((()=>[S(i,{label:"角色名:",prop:"name"},{default:P((()=>[S(o,{modelValue:w(s).name,"onUpdate:modelValue":a[1]||(a[1]=e=>w(s).name=e),placeholder:"admin"},null,8,["modelValue"])])),_:1}),S(i,{label:"昵称:",prop:"nickname"},{default:P((()=>[S(o,{modelValue:w(s).nickname,"onUpdate:modelValue":a[2]||(a[2]=e=>w(s).nickname=e),placeholder:"管理员"},null,8,["modelValue"])])),_:1}),S(i,{label:"功能权限:"},{default:P((()=>[S(o,{modelValue:J.value,"onUpdate:modelValue":a[3]||(a[3]=e=>J.value=e),placeholder:"输入关键字进行过滤",size:"small",clearable:""},null,8,["modelValue"]),S("div",N,[z(S(d,{data:w(n),"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading",ref:L,props:{label:"title"},"highlight-current":"",accordion:"","node-key":"id","default-checked-keys":w(m),onCheckChange:E,"filter-node-method":F,"show-checkbox":""},null,8,["data","default-checked-keys"]),[[p,w(t).user.btnLoading]])])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}}});F.__scopeId="data-v-491cadd0";const J=C();O("data-v-fc63d17e");const E=x("新增");V();var K=m({setup(e){const{commit:l}=o(),a=p("reload",Function),t=b();function n(){t.value.visible=!0}function i(e){l("user/btnLoading"),c.add(e).then((e=>{t.value.visible=!1,a()}))}return L(u,r),L("menuIds",b()),(e,l)=>{const a=h("el-button");return _(),k(U,null,[S(a,{type:"primary",size:"mini",icon:"el-icon-plus",onClick:n},{default:J((()=>[E])),_:1}),S(F,{msg:"添加角色",ref:t,onSubmit:i},null,512)],64)}}});K.__scopeId="data-v-fc63d17e";const T=C();var q=m({props:{type:String,msg:String,disabled:Boolean},emits:["onUpdate"],setup(e,{emit:i}){const s=e,{commit:d}=o(),r=p("reload",Function),u=b();function m(){i("onUpdate"),u.value.visible=!0}function f(e){d("user/btnLoading"),c.update(((e,o)=>{for(var i in o||(o={}))a.call(o,i)&&n(e,i,o[i]);if(l)for(var i of l(o))t.call(o,i)&&n(e,i,o[i]);return e})({urlParam:`/${e.menuIdList}`},e.role)).then((e=>{u.value.visible=!1,r()}))}return(l,a)=>{const t=h("el-button");return _(),k(U,null,[S(t,{size:"mini",disabled:e.disabled,type:s.type,icon:"el-icon-edit",onClick:m},{default:T((()=>[x(j(s.msg),1)])),_:1},8,["disabled","type"]),S(F,{msg:"修改用户",ref:u,onSubmit:f},null,512)],64)}}});q.__scopeId="data-v-ff302aa6";const B=C();O("data-v-05b8b8bd");const A={class:"view"},G={class:"role"},H=x("刷新"),M=x("删除");V();var Q=m({setup(e){const{state:l,commit:a}=o(),t=g({total:0,pageSize:5,pageNum:1,role:[],editDisabled:!0,deleteDisabled:!0,multipleSelection:[]});function n(e){t.pageSize=e,O()}function m(e){t.pageNum=e,O()}function p(e){t.editDisabled=1!=e.length,t.deleteDisabled=0==e.lenght,t.multipleSelection=e}L(u,r);const f=b();function v(e){const l=JSON.parse(JSON.stringify(e));r.value.role=l,a("user/btnLoading"),c.perm({urlParam:`/${l.id}`}).then((e=>{let l=[];const a=i(e.data),t=e=>{e.forEach((e=>{e.children?t(e.children):l.push(e.id)}))};t(a),f.value=l}))}L("menuIds",f);const C=b([]);function O(){a("user/showLoading"),c.page({urlParam:`/${t.pageNum}/${t.pageSize}`}).then((e=>{t.role=e.data.list,t.total=e.data.total}))}L(d,C);const x=b();function V(){O(),s.list().then((e=>{C.value=i(e.data)})),x.value&&x.value.clearSelection()}function U(e){I.confirm("确认删除?").then((()=>{let l=e.map((e=>e.id));a("user/btnLoading"),c.del({urlParam:`/${l}`}).then((e=>{V()}))}))}return V(),L("reload",V),(e,a)=>{const o=h("el-button"),i=h("el-space"),s=h("el-table-column"),d=h("el-table"),r=h("el-pagination"),u=h("el-scrollbar"),c=y("loading");return _(),k("div",A,[S(u,null,{default:B((()=>[S("div",G,[S(i,{size:10},{default:B((()=>[S(o,{size:"mini",icon:"el-icon-refresh",onClick:V},{default:B((()=>[H])),_:1}),S(K),S(q,{disabled:w(t).editDisabled,type:"success",msg:"修改",onOnUpdate:a[1]||(a[1]=e=>v(w(t).multipleSelection[0]))},null,8,["disabled"]),S(o,{type:"danger",size:"mini",icon:"el-icon-delete",disabled:w(t).deleteDisabled,onClick:a[2]||(a[2]=e=>U(w(t).multipleSelection))},{default:B((()=>[M])),_:1},8,["disabled"])])),_:1}),z(S(d,{data:w(t).role,stripe:"","header-cell-style":{background:"#f5f7fa",color:"#606266"},"max-height":"500",ref:x,onSelectionChange:p,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"},{default:B((()=>[S(s,{type:"selection",width:"50"}),S(s,{label:"角色名称",prop:"name","show-overflow-tooltip":"","min-width":"150"}),S(s,{label:"昵称",prop:"nickname","show-overflow-tooltip":"","min-width":"150"}),S(s,{label:"创建时间",prop:"createTime",width:"180"}),S(s,{label:"修改时间",prop:"updateTime",width:"180"}),S(s,{label:"版本",prop:"version","min-width":"50"}),S(s,{label:"操作",fixed:"right",width:"130"},{default:B((e=>[S(i,null,{default:B((()=>[S(q,{type:"primary",onOnUpdate:l=>v(e.row)},null,8,["onOnUpdate"]),S(o,{type:"danger",size:"mini",icon:"el-icon-delete",onClick:l=>U([e.row])},null,8,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"]),[[c,w(l).user.loading]]),S(r,{layout:"total, sizes, pre, pager, next, jumper",small:"",total:w(t).total,"page-sizes":[5,10,20,40],"page-size":w(t).pageSize,background:"",onCurrentChange:m,onSizeChange:n},null,8,["total","page-size"])])])),_:1})])}}});Q.__scopeId="data-v-05b8b8bd";var R=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Q});export{R as _};
