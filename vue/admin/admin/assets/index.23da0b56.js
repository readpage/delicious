var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,n=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t;import{u as o,e as i,f as s}from"./index.75106888.js";import{I as d,r,a as u,A as c}from"./index.b1ccad6a.js";import{e as m,V as p,C as f,m as b,y as g,P as v,r as h,S as y,o as _,f as k,h as S,g as w,U as z,H as C,t as O,M as V,x,b as I,X as U,F as j,G as L}from"./vendor.6bddc292.js";const P=C();O("data-v-491cadd0");const N={class:"scrollbar"},D=V("确定"),$=V("取消");x();var F=m({props:{msg:String},emits:["submit"],setup(e,{expose:l,emit:a}){const{state:t}=o(),n=p(d),i=p(u,r),{role:s,menuIdList:c}=f(i.value),m=p("menuIds",b([])),C=b(!1),O=b(),V=g({name:{required:!0,message:"请输入角色名"},nickname:{required:!0,message:"请输入昵称"}});function x(){O.value.validate((e=>{e&&a("submit",i.value)}))}const U=b();function j(){O.value.resetFields(),U.value.setCheckedKeys([]),m.value=[]}function L(e){I.confirm("确认关闭?").then((()=>{e()}))}function F(e,l){return!e||l.title.includes(e)}const J=b("");function K(){const e=U.value.getCheckedKeys(),l=U.value.getHalfCheckedKeys();c.value=JSON.parse(JSON.stringify([...e,...l]))}return v(J,(e=>{U.value.filter(e)})),l({visible:C}),(l,a)=>{const o=h("el-input"),i=h("el-form-item"),d=h("el-tree"),r=h("el-form"),u=h("el-button"),c=h("el-dialog"),p=y("loading");return _(),k(c,{title:e.msg,modelValue:C.value,"onUpdate:modelValue":a[5]||(a[5]=e=>C.value=e),onClose:j,"before-close":L},{footer:P((()=>[S(u,{type:"primary",size:"small",loading:w(t).user.btnLoading,onClick:x},{default:P((()=>[D])),_:1},8,["loading"]),S(u,{size:"small",onClick:a[4]||(a[4]=e=>C.value=!1)},{default:P((()=>[$])),_:1})])),default:P((()=>[S(r,{model:w(s),ref:O,rules:w(V),"label-width":"80px",size:"small"},{default:P((()=>[S(i,{label:"角色名:",prop:"name"},{default:P((()=>[S(o,{modelValue:w(s).name,"onUpdate:modelValue":a[1]||(a[1]=e=>w(s).name=e),placeholder:"admin"},null,8,["modelValue"])])),_:1}),S(i,{label:"昵称:",prop:"nickname"},{default:P((()=>[S(o,{modelValue:w(s).nickname,"onUpdate:modelValue":a[2]||(a[2]=e=>w(s).nickname=e),placeholder:"管理员"},null,8,["modelValue"])])),_:1}),S(i,{label:"功能权限:"},{default:P((()=>[S(o,{modelValue:J.value,"onUpdate:modelValue":a[3]||(a[3]=e=>J.value=e),placeholder:"输入关键字进行过滤",size:"small",clearable:""},null,8,["modelValue"]),S("div",N,[z(S(d,{data:w(n),"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading",ref:U,props:{label:"title"},"highlight-current":"",accordion:"","node-key":"id","default-checked-keys":w(m),onCheckChange:K,"filter-node-method":F,"show-checkbox":""},null,8,["data","default-checked-keys"]),[[p,w(t).user.btnLoading]])])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}}});F.__scopeId="data-v-491cadd0";const J=C();O("data-v-fc63d17e");const K=V("新增");x();var T=m({setup(e){const{commit:l}=o(),a=p("reload",Function),t=b();function n(){t.value.visible=!0}function i(e){l("user/btnLoading"),c.add(e).then((e=>{t.value.visible=!1,a()}))}return U(u,r),U("menuIds",b()),(e,l)=>{const a=h("el-button");return _(),k(j,null,[S(a,{type:"primary",size:"mini",icon:"el-icon-plus",onClick:n},{default:J((()=>[K])),_:1}),S(F,{msg:"添加角色",ref:t,onSubmit:i},null,512)],64)}}});T.__scopeId="data-v-fc63d17e";const q=C();var E=m({props:{type:String,msg:String,disabled:Boolean},emits:["onUpdate"],setup(e,{emit:i}){const s=e,{commit:d}=o(),r=p("reload",Function),u=b();function m(){i("onUpdate"),u.value.visible=!0}function f(e){d("user/btnLoading"),c.update(((e,o)=>{for(var i in o||(o={}))a.call(o,i)&&n(e,i,o[i]);if(l)for(var i of l(o))t.call(o,i)&&n(e,i,o[i]);return e})({urlParam:`/${e.menuIdList}`},e.role)).then((e=>{u.value.visible=!1,r()}))}return(l,a)=>{const t=h("el-button");return _(),k(j,null,[S(t,{size:"mini",disabled:e.disabled,type:s.type,icon:"el-icon-edit",onClick:m},{default:q((()=>[V(L(s.msg),1)])),_:1},8,["disabled","type"]),S(F,{msg:"修改用户",ref:u,onSubmit:f},null,512)],64)}}});E.__scopeId="data-v-ff302aa6";const H=C();O("data-v-05b8b8bd");const M={class:"view"},A={class:"role"},B=V("刷新"),G=V("删除");x();var X=m({setup(e){const{state:l,commit:a}=o(),t=g({total:0,pageSize:5,pageNum:1,role:[],editDisabled:!0,deleteDisabled:!0,multipleSelection:[]});function n(e){t.pageSize=e,O()}function m(e){t.pageNum=e,O()}function p(e){t.editDisabled=1!=e.length,t.deleteDisabled=0==e.lenght,t.multipleSelection=e}U(u,r);const f=b();function v(e){const l=JSON.parse(JSON.stringify(e));r.value.role=l,a("user/btnLoading"),c.perm({urlParam:`/${l.id}`}).then((e=>{let l=[];const a=i(e.data),t=e=>{e.forEach((e=>{e.children?t(e.children):l.push(e.id)}))};t(a),f.value=l}))}U("menuIds",f);const C=b([]);function O(){a("user/showLoading"),c.page({urlParam:`/${t.pageNum}/${t.pageSize}`}).then((e=>{t.role=e.data.list,t.total=e.data.total}))}U(d,C);const V=b();function x(){O(),s.list().then((e=>{C.value=i(e.data)})),V.value&&V.value.clearSelection()}function j(e){I.confirm("确认删除?").then((()=>{let l=e.map((e=>e.id));a("user/btnLoading"),c.del({urlParam:`/${l}`}).then((e=>{x()}))}))}return x(),U("reload",x),(e,a)=>{const o=h("el-button"),i=h("el-space"),s=h("el-table-column"),d=h("el-table"),r=h("el-pagination"),u=h("el-scrollbar"),c=y("loading");return _(),k("div",M,[S(u,null,{default:H((()=>[S("div",A,[S(i,{size:10},{default:H((()=>[S(o,{size:"mini",icon:"el-icon-refresh",onClick:x},{default:H((()=>[B])),_:1}),S(T),S(E,{disabled:w(t).editDisabled,type:"success",msg:"修改",onOnUpdate:a[1]||(a[1]=e=>v(w(t).multipleSelection[0]))},null,8,["disabled"]),S(o,{type:"danger",size:"mini",icon:"el-icon-delete",disabled:w(t).deleteDisabled,onClick:a[2]||(a[2]=e=>j(w(t).multipleSelection))},{default:H((()=>[G])),_:1},8,["disabled"])])),_:1}),z(S(d,{data:w(t).role,stripe:"","header-cell-style":{background:"#f5f7fa",color:"#606266"},"max-height":"500",ref:V,onSelectionChange:p,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"},{default:H((()=>[S(s,{type:"selection",width:"50"}),S(s,{label:"角色名称",prop:"name","show-overflow-tooltip":"","min-width":"150"}),S(s,{label:"昵称",prop:"nickname","show-overflow-tooltip":"","min-width":"150"}),S(s,{label:"创建时间",prop:"createTime",width:"180"}),S(s,{label:"修改时间",prop:"updateTime",width:"180"}),S(s,{label:"版本",prop:"version","min-width":"50"}),S(s,{label:"操作",fixed:"right",width:"130"},{default:H((e=>[S(i,null,{default:H((()=>[S(E,{type:"primary",onOnUpdate:l=>v(e.row)},null,8,["onOnUpdate"]),S(o,{type:"danger",size:"mini",icon:"el-icon-delete",onClick:l=>j([e.row])},null,8,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"]),[[c,w(l).user.loading]]),S(r,{layout:"total, sizes, pre, pager, next, jumper",small:"",total:w(t).total,"page-sizes":[5,10,20,40],"page-size":w(t).pageSize,background:"",onCurrentChange:m,onSizeChange:n},null,8,["total","page-size"])])])),_:1})])}}});X.__scopeId="data-v-05b8b8bd";var Q=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:X});export{Q as _};
