import{c as e,u as l}from"./index.bf837159.js";import{e as o,m as a,x as t,r as i,o as n,f as s,w as d,h as r,g as u,L as p,b as c,P as m,Q as f,G as g,t as b,v}from"./vendor.f7504fb0.js";const h={page:e("/foods/page"),save:e("/foods/save","post"),update:e("/foods/update","put"),remove:e("/foods/remove","delete")},_=p("确定"),y=p("取消");var z=o({props:{msg:{type:String,required:!0},food:{type:null,required:!0}},emits:["submit"],setup(e,{expose:o,emit:p}){const m=e,{state:f}=l(),g=a(),b=a(),v=a(!1),h=t({name:{required:!0,message:"请输入名称"},price:{required:!0,message:"请输入价格"}});function z(e){m.food.imgList=e}function S(){b.value.clearFiles(),g.value.resetFields()}function w(e){m.food.img=e.data}function C(e){c.confirm("确认关闭?").then((()=>{e()}))}function k(){g.value.validate((e=>{e&&p("submit")}))}return o({visible:v}),(l,o)=>{const a=i("v-upload"),t=i("el-form-item"),p=i("el-input"),c=i("el-form"),m=i("el-button"),x=i("el-dialog");return n(),s(x,{title:e.msg,modelValue:v.value,"onUpdate:modelValue":o[4]||(o[4]=e=>v.value=e),onClose:S,"before-close":C},{footer:d((()=>[r(m,{type:"primary",size:"small",loading:u(f).user.btnLoading,onClick:k},{default:d((()=>[_])),_:1},8,["loading"]),r(m,{size:"small",onClick:o[3]||(o[3]=e=>v.value=!1)},{default:d((()=>[y])),_:1})])),default:d((()=>[r(c,{model:e.food,ref:g,rules:u(h),"label-width":"80px",size:"small"},{default:d((()=>[r(t,{label:"图片",prop:"img"},{default:d((()=>[r(a,{ref:b,action:"/api/file/upload","file-list":e.food.imgList,onSuccess:w,onUpdImg:z},null,8,["file-list"])])),_:1}),r(t,{label:"名称",prop:"name"},{default:d((()=>[r(p,{modelValue:e.food.name,"onUpdate:modelValue":o[1]||(o[1]=l=>e.food.name=l),placeholder:"请输入名称",clearable:""},null,8,["modelValue"])])),_:1}),r(t,{label:"价格",prop:"price"},{default:d((()=>[r(p,{modelValue:e.food.price,"onUpdate:modelValue":o[2]||(o[2]=l=>e.food.price=l),placeholder:"请输入价格",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}}});const S=g();b("data-v-be0e62f0");const w={class:"cl-table"},C=p("刷新"),k=p("新增"),x=p(" 修改 "),L=p(" 删除 ");v();var V=o({props:{foods:{type:Array,required:!0},total:{type:Number,required:!0}},emits:["page","save","remove"],setup(e,{expose:o,emit:d}){const{state:p,commit:g}=l(),b=t({total:0,pageSize:5,pageNum:1,food:{},msg:"添加餐品",editDisabled:!0,deleteDisabled:!0,multipleSelection:[]}),v=a(),h=a();function _(e){b.pageSize=e,d("page",b)}function y(e){b.pageNum=e,d("page",b)}function V(e){b.editDisabled=1!=e.length,b.deleteDisabled=0==e.length,b.multipleSelection=e}function q(e){v.value.visible=!0,b.food=JSON.parse(JSON.stringify(e));let l=b.food.img;b.food.imgList=l?[{url:l}]:[]}function D(){g("user/btnLoading"),d("save",b.food)}function F(e){c.confirm("确认删除?").then((()=>{let l=e.map((e=>e.id));g("user/btnLoading"),d("remove",l)}))}function N(){d("page",b),h.value&&h.value.clearSelection()}return N(),o({closeForm:function(){v.value.visible=!1,N()}}),(l,o)=>{const a=i("el-button"),t=i("el-space"),d=i("el-table-column"),c=i("el-image"),g=i("el-table"),j=i("el-pagination"),P=m("loading");return n(),s("div",w,[r(t,{size:10},{default:S((()=>[r(a,{size:"mini",icon:"el-icon-refresh",onClick:N},{default:S((()=>[C])),_:1}),r(a,{type:"primary",size:"mini",icon:"el-icon-plus",onClick:q},{default:S((()=>[k])),_:1}),r(a,{size:"mini",type:"success",icon:"el-icon-edit",onClick:o[1]||(o[1]=e=>q(u(b).multipleSelection[0])),disabled:u(b).editDisabled},{default:S((()=>[x])),_:1},8,["disabled"]),r(a,{size:"mini",type:"danger",icon:"el-icon-delete",loading:u(p).user.btnLoading,onClick:o[2]||(o[2]=e=>F(u(b).multipleSelection)),disabled:u(b).deleteDisabled},{default:S((()=>[L])),_:1},8,["loading","disabled"])])),_:1}),f(r(g,{data:e.foods,stripe:"",ref:h,"header-cell-style":{background:"#f5f7fa",color:"#606266"},"max-height":"500",onSelectionChange:V,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"},{default:S((()=>[r(d,{type:"selection",width:"50"}),r(d,{label:"名称",prop:"name","show-overflow-tooltip":""}),r(d,{label:"图片",prop:"img",width:"120"},{default:S((e=>[r(c,{src:e.row.img,style:{height:"58px"},"preview-src-list":[e.row.img],fit:"cover"},null,8,["src","preview-src-list"])])),_:1}),r(d,{label:"价格",prop:"price",width:"80"}),r(d,{label:"类型",prop:"type"}),r(d,{label:"创建时间",prop:"createTime",width:"160"}),r(d,{label:"修改时间",prop:"updateTime",width:"160"}),r(d,{label:"操作",fixed:"right",width:"135"},{default:S((e=>[r(t,null,{default:S((()=>[r(a,{size:"mini",type:"primary",icon:"el-icon-edit",onClick:l=>q(e.row)},null,8,["onClick"]),r(a,{size:"mini",type:"danger",icon:"el-icon-delete",loading:u(p).user.btnLoading,onClick:l=>F([e.row])},null,8,["loading","onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"]),[[P,u(p).user.loading]]),r(j,{layout:"total, sizes, pre, pager, next, jumper",small:"",total:e.total,"page-sizes":[5,10,20,40],"page-size":u(b).pageSize,background:"",onCurrentChange:y,onSizeChange:_},null,8,["total","page-size"]),r(z,{msg:u(b).msg,food:u(b).food,ref:v,onSubmit:D},null,8,["msg","food"])])}}});V.__scopeId="data-v-be0e62f0";const q=g();b("data-v-7e002905");const D={class:"foods"};v();var F=o({setup(e){const{state:o,commit:d}=l(),p=t({foods:[],total:0}),c=a();function m({pageNum:e,pageSize:l}){d("user/showLoading"),h.page({urlParam:`/${e}/${l}`}).then((e=>{p.foods=e.data.list,p.total=e.data.total}))}function f(e){e.id?h.update(e).then((e=>{var l;null==(l=c.value)||l.closeForm()})):h.save(e).then((e=>{var l;null==(l=c.value)||l.closeForm()}))}function g(e){h.remove({urlParam:`/${e}`}).then((e=>{var l;null==(l=c.value)||l.closeForm()}))}return(e,l)=>{const o=i("el-scrollbar");return n(),s("div",D,[r(o,null,{default:q((()=>[r(V,{ref:c,foods:u(p).foods,total:u(p).total,onPage:m,onSave:f,onRemove:g},null,8,["foods","total"])])),_:1})])}}});F.__scopeId="data-v-7e002905";var N=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:F});export{N as _};
